# Change Log

## [1.3.1] - 2024-8-9

### Added

- 增加親眷朋友關係由 Google 試算表匯入資料庫
- 設定檔增加 Google 的資訊

```yaml
google:
  spreadsheets:
    # 親眷朋友關係
    relationships:
      spreadsheet_id: '試算表的 Google ID'
      sheet_name: '親眷朋友關係'
      header_row: 2
      fields_map:
        'fullName': '姓名'
        'dharmaName': '法名'
        'gender': '性別'
        'studentId': '學員編號'
        'birthday': '生日末四碼'
        'phone': '行動電話末四碼'
        'relationKeys':
          - '關係代碼1'
          - '關係代碼2'
          - '關係代碼3'
          - '關係代碼4'
          - '關係代碼5'
          - '關係代碼6' 
```

## [1.3.0] - 2024-8-8

### Added

- 增加編班 A 表產出時, 可參照 B 表預設名單產生新的 A 表。
- 增加產出「班級分組人數概況表」。
- 增加讀取禪修班意願調查表中, 備註關於: 「與xxx同組」 的資料，在編組時會設法依需求編組。
- 增加意願調查表中，資料重覆的檢查。
- 增加新學員的姓名在基本資料中存在，但因基本資料缺少生日無法比對的警告。
- 增加簡易版及完整版的版面及切換
- 讀取 Excel 時, 如果連續 10 行讀不到必要資料時, 就忽略後面的資料。

### Fixed

- 修正本來要用 MS-Access，結果還是嘗試做資料庫連線的錯誤。

## [1.2.0] - 2024-8-2

### Added

- 增加程式設計師工具小品 - 檔案欄位編碼/解碼

### Changed

- 重新調整主畫面

## [1.1.0] - 2024-7-31

### Added

- 增加利用上課記錄(當個資系統的資料)比對，以確定個資系統與 Google 上的班級學員資料的一致性。
- 增加從 MySQL 上的班級學員複製到 MS-Access DB (供無法連 MySQL 資料庫電腦使用)。
- 增加用姓名(法名) vlookup 班級/組別的功能。
-
    - 可選擇使用 MySQL 資料庫或 MS-Access 資料庫做法學員名單的來源。
-
    - 支援的欄位名稱 (個資系統標準命名):
-
    -
        - 學員編號 : 可做為查詢或回填 (以姓名回填學員編號)
-
    -
        - 姓名 : 可做為查詢或回填 (以學員編號回填姓名)
-
    -
        - 法名 : 輔助姓名查詢用, 或回填
-
    -
        - 班級 : 空白時回填
-
    -
        - 組別 : 空白時回填
-
    -
        - 學長 : 空白時回填
-
    -
        - 性別 : 空白時回填
-
    -
        - 出生日期 : 空白時回填
-
    -
        - 行動電話 : 空白時回填
-
    -
        - 住家電話 : 空白時回填
-
    - 以姓名 vlookup 時, 可在必要時加法名輔助, 加法名輔助的方式有兩種:
-
    -
        - 僅用姓名欄, 格式如: 孫行者(悟空), 請用半形括號。
-
    -
        - 用姓名欄跟法名欄
-
    - 會產生一新的檔案，放置於原始檔相同目錄，並以原檔名加上日期做識別。

### Changed

- 把自動分班演算法說明移到\[產出\] 學長電聯表(產生 A 表)裡面。
- 因應新的需求，主畫面增加一排。

## [1.0.1] - 2024-7-24

### Added

- 增加 ChangeLog 關於 1.0.0 版, config.yaml 檔的修改
- 更新 config-sample.yaml 檔
- config.yaml 檔增加的部份如下

```yaml
# Google 試算表相關設定
google:
  spreadsheets:
    # 當前的班級成員
    class_members:
      # 可調整欄位名稱
      fields_map:
        sn: '總序'
        studentId: '學員編號(公式)'
        className: '班級'
        classGroup: '組別'
        fullName: '姓名'
        dharmaName: '法名'
        gender: '性別'
        senior: '學長'
        deacon: '執事'
        # 可多筆升班意願
        nextClasses:
          - '學員上課班別'
          - '發心上第二班禪修班'

# MS Excel 的相關詋定
excel:
  # 學員基本資料更新
  member_details_update:
    spreadsheet_folder: '{WORKSPACE}\學員資料更新'
    header_row: 1
```

### Fixed

- 修正主程式測試用的 Flag 被開啟的問題

## [1.0.0] - 2024-7-24

### Added

- 增加讀取 B 表, 重新產生學長電聯表, 同時對未分配組別的學員做人數少的組優先的分配。
- 增加學員基本資料的匯出及匯入更新的功能。
- 增加 Change Log。
- 讀取 Google Spreadsheet 時, 也可以讀取公式。
- 增加讀取 Access 資料庫中, 已領取福慧卡的名單。(規格未明確, 暫時只做到此)

### Changed

- 新班 A, B 表樣版調整
-
    - 「自動編班資訊」改為「備註」。在 A 表產出時提供編班參考資訊, 改成 B 表時, 可以人工填上需要資訊。
-
    - 增加「B 表處理備註」, 程式處理 B 表時的處理資訊會寫在這裡, 「備註」的部份則保留不動。

### Fixed

- 修改介紹人的學員身份檢查時，忽略基本資料是否存在此姓名。
- 修正 Log Level 設定無法在 stderr 上生效的問題。
- 修正讀取 Google 的升班調查中, 升班意願轉成 set 的 BUG。
- 修正介紹人有兩個班以上時, 以學長/副學長為優先。

## [0.1.3] - 2024-7-18

### Added

- 介紹人電聯表"喫茶趣"欄位未顯示。
- 介紹人電聯表每換介紹人時, 增加表頭一次。
- 升班調查改直接讀取 Google 試算表。其中, 程式使用的欄位名稱可透過設定檔調整。
- 增加 TODO

### Changed

- 學長升班分班資料在低班而在高班沒能分配到原班。
-
    - 說明: 僅調整那些上課班名跟意願班名相同的至上課班級。
- BUG: 介紹人電聯表兒童班問題(沒有學長, 還是應由介紹人連絡)。

### Fixed
 